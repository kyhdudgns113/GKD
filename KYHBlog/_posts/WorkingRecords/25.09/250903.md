<div class="block_white">

## **고민: 알람 작동방식**

<div class="block_red">

### **다음 경우에 대해서 상단 알람이 뜨도록 하고싶다.**

1. #### 본인이 작성한 파일에 댓글이 달렸을때

2. #### 본인이 작성한 파일에 대댓글이 달렸을때

3. #### 본인이 작성한 댓글에 대댓글이 달렸을때(태그 본인인지 구분)

4. #### 본인이 작성한 대댓글에 대댓글이 달렸을때

5. #### 채팅은 상단 알람이 뜨지 않는다.

    + 채팅방에서 안 읽은 메시지를 갱신하던가 한다.

</div>

<div class="block_yellow">

### **상단 알람의 생김새**

<div class="block_half_transparent">

#### **알람 버튼을 클릭하면 알람들의 목록이 나온다.**

- 이미 눌러서 확인한 알람은 나오지 않도록 한다. (내용 확인 상태)

- 왔다는걸 확인만 한 알람은 나오도록 한다. (수신 확인 상태)

</div>

<div class="block_half_transparent">

#### **알람 버튼을 클릭하면 수신한 모든 알람들을 전부 [수신 확인 상태] 로 한다.**

- 수신 확인도 안 했던 알람이랑 구분하여 표시한다.

</div>

<div class="block_half_transparent">

#### **알람 목록이 너무 많으면?**

- 최대 높이를 정하고 스크롤로 내리도록 하자.

</div>

</div>

<div class="block_green">

### **알람 블록의 생김새**

- #### 상단 알람 버튼을 눌렀을때 나오는 알람 개별 블록의 생김새에 대한 고민이다.

- #### 기본 형식은 통일하되, 댓글인지, 대댓글인지, 태그상태인지 등만 구분해주자

- #### 알람을 클릭하면 해당 파일로 이동하도록 하자

- #### 해당 알람이 발생한 댓글이나 대댓글로 이동하는건 정말 나중으로 미루자

</div>

<div class="block_blue">

### **알람 데이터 구성**

<div class="block_half_transparent">

#### **userOId** 

- 알람을 수신할 유저의 PRIMARY KEY

- 수신할 대상은 있어야 하기에 필수적으로 있어야 한다.

</div>

<div class="block_half_transparent">

#### **alarmStatus** 

- 알람의 상태

- [날것의 상태], [수신 확인 상태], [내용 확인 상태] 3가지 경우가 있다.

- [내용 확인 상태] 이면 알람이 DB 에 저장되어있을 필요가 없다.

</div>

<div class="block_half_transparent">

#### **targetUserName** 

- 알람을 발생시킨 유저의 닉네임

- 알람의 내용을 직관적으로 확인하기 위해서 필요하다.

</div>

<div class="block_half_transparent">

#### **targetUserOId** 

- 알람을 발생시킨 유저의 PRIMARY KEY

- 알람 확인할때 이걸 쓰지는 않는다.

- 내가 나한테 알람을 발생시키면 안되기 때문에 http 데이터로는 수신한다.

- **DB 에 저장할 필요는 없는것 같다.**

</div>

<div class="block_half_transparent">

#### **alarmType** 

- 알람의 타입

- 알람이 어떤 상황에서 떴는지를 저장한다.

- 클라이언트에 표시해줄때 사용한다.

</div>

<div class="block_half_transparent">

#### **content** 

- 알람의 내용

- 댓글이 달렸다면 댓글의 내용, 대댓글이 달렸다면 대댓글의 내용이다.

</div>

<div class="block_half_transparent">

#### **fileOId** 

- 이동 대상

- 알람을 클릭하면 이동할 파일의 PRIMARY KEY 이다.

</div>

</div>

</div>

------

<div class="block_grey">

## **고민: 소켓 구성**

<div class="block_red_transparent">

### **고려할점**

<div class="block_half_transparent">

#### **유저 개인으로써 서버와 통신할 소켓이 필요하다.**

- **[메인 소켓]** 으로 명명

- 알람 수신

- 채팅방의 안 읽은 채팅 갯수 수신

</div>

<div class="block_half_transparent">

#### **열려져 있는 채팅방의 채팅을 위한 소켓이 필요하다.**

- **[채팅 소켓]** 으로 명명

- 실시간 채팅 내용 수신

</div>

</div>

<div class="block_yellow_transparent">

### **소켓을 별도로 쓸지 여부**

- #### **[메인 소켓]** 과 **[채팅 소켓]** 을 별도로 쓸 지 여부

- #### 관리는 편할 수 있는데, 네트워크 부하가 생길 수 있다.

- #### 하나로 쓰는 편이 나을것 같다.

</div>

</div>